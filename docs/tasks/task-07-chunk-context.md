# TASK-07: μ²­ν¬ κ°„ μ»¨ν…μ¤νΈ μ „λ‹¬ (μ΄μ „ λ¬Έν•­ μ •λ³΄ μ£Όμ…)

## Status: πΆ Complete

## Problem
λ©€ν‹° μ²­ν¬ μ¶”μ¶ μ‹ κ° μ²­ν¬κ°€ λ…λ¦½μ μΌλ΅ μ²λ¦¬λμ–΄ λ‹¤λ¥Έ μ²­ν¬μ λ¬Έν•­ μ •λ³΄λ¥Ό λ¨λ¦„.
`_build_prompt()`μ€ `[Section N of M]` ν‘μ‹λ§ ν•κ³  μ΄μ „/μ΄ν›„ μ²­ν¬μ λ¬Έν•­λ²νΈλ¥Ό μ „λ‹¬ν•μ§€ μ•μ.
μ΄λ΅ μΈν•΄:
- λ¬Έν•­ λ²νΈ ν¨ν„΄ μΈμ‹ μ‹¤ν¨ (Q1-Q20μ΄ μ΄μ „ μ²­ν¬μ— μμ„ λ• Q21+λ¥Ό μΈμ‹ λ»ν•¨)
- κ²½κ³„ λ¬Έν•­ λ„λ½ (μ²­ν¬ κ²½κ³„μ— κ±ΈμΉ λ¬Έν•­)
- μ°Έμ΅° ν•΄κ²° λ¶κ°€ ("Same as Q5" β€” Q5κ°€ λ‹¤λ¥Έ μ²­ν¬μ— μμ„ λ•)

## Changes Made
- `services/llm_extractor.py`:
  - **`_build_chunk_context()` μ‹ μ„¤**: μ²­ν¬λ³„ μ»¨ν…μ¤νΈ λΉλ”
    - λ‹¤λ¥Έ λ¨λ“  μ²­ν¬μ μ •κ·μ‹ μ‚¬μ „ μ¶”μ¶ λ¬Έν•­λ²νΈλ¥Ό previous/later λ μ΄λΈ”κ³Ό ν•¨κ» μ”μ•½
    - μ΄μ „ μ²­ν¬μ λ§μ§€λ§‰ ~500μλ¥Ό κ²½κ³„ μ—°μ†μ„± μ»¨ν…μ¤νΈλ΅ ν¬ν•¨
    - λ‹¨μΌ μ²­ν¬ μ‹ λΉ λ¬Έμμ—΄ λ°ν™
  - **`_build_prompt()` ν™•μ¥**: `chunk_context` λ§¤κ°λ³€μ μ¶”κ°€
    - μ»¨ν…μ¤νΈ μ΅΄μ¬ μ‹ `---DOCUMENT CONTEXT---` λΈ”λ΅ μ‚½μ…
    - LLMμ— μ¤‘λ³µ λ°©μ§€ λ° ν„μ¬ μ„Ήμ… μ§‘μ¤‘ μ§€μ‹
  - **`extract_questions_from_chunk()` ν™•μ¥**: `chunk_context` λ§¤κ°λ³€μ μ¶”κ°€
  - **`extract_survey_questions()` 1-cλ‹¨κ³„ μ¶”κ°€**: μ •κ·μ‹ μ‚¬μ „ μ¶”μ¶ μ™„λ£ ν›„ κ° μ²­ν¬λ³„ μ»¨ν…μ¤νΈ λΉλ“
    - λ³‘λ ¬ μ²λ¦¬ μ μ§€ (μ •κ·μ‹ κ²°κ³Όλ” LLM νΈμ¶ μ „μ— λ¨λ‘ μ‚¬μ© κ°€λ¥)
- `tests/smoke_test_chunk_context.py`: μ»¨ν…μ¤νΈ λΉλ” + ν”„λ΅¬ν”„νΈ ν†µν•© ν…μ¤νΈ (10+ μΌ€μ΄μ¤)

## Design Decisions
- **λ³‘λ ¬ μ²λ¦¬ μ μ§€**: μ •κ·μ‹ μ‚¬μ „ μ¶”μ¶ κ²°κ³Όλ¥Ό μ»¨ν…μ¤νΈλ΅ μ‚¬μ©ν•μ—¬ LLM λ³‘λ ¬ νΈμ¶ μ μ§€
- **μ΄μ „ μ²­ν¬ LLM κ²°κ³Ό λ―Έμ‚¬μ©**: μμ°¨ μ²λ¦¬ ν•„μ” β†’ μ„±λ¥ μ €ν• μ°λ ¤. μ •κ·μ‹ λ¬Έν•­λ²νΈλ§μΌλ΅ μ¶©λ¶„ν• μ»¨ν…μ¤νΈ μ κ³µ
- **500μ tail**: μ΄μ „ μ²­ν¬ λ§λ―Έλ¥Ό ν†µν•΄ κ²½κ³„ λ¬Έν•­μ μ—°μ†μ„± λ³΄μ¥
